{
  "bindings": [
    {
      "name": "metadata",
      "type": "blobTrigger",
      "direction": "in",
      "path": "emails/{correlationId}/metadata.json",
      "connection": "AzureWebJobsStorage"
    },
    {
      "name": "existingDoc",
      "type": "cosmosDB",
      "direction": "in",
      "databaseName": "hrdb",
      "collectionName": "emails",
      "id": "{metadata.messageId}",
      "partitionKey": "{metadata.fromEmail}",
      "connection": "CosmosDBConnection"
    },
    {
      "name": "cosmosDoc",
      "type": "cosmosDB",
      "direction": "out",
      "databaseName": "hrdb",
      "collectionName": "emails",
      "createIfNotExists": true,
      "connection": "CosmosDBConnection"
    }
  ],
  "scriptFile": "run.ps1"
}
